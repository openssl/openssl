/*
 * Written by Dr Stephen N Henson (steve@openssl.org) for the OpenSSL project
 * 2011.
 */
/* ====================================================================
 * Copyright (c) 2011 The OpenSSL Project.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in
 *    the documentation and/or other materials provided with the
 *    distribution.
 *
 * 3. All advertising materials mentioning features or use of this
 *    software must display the following acknowledgment:
 *    "This product includes software developed by the OpenSSL Project
 *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"
 *
 * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
 *    endorse or promote products derived from this software without
 *    prior written permission. For written permission, please contact
 *    licensing@OpenSSL.org.
 *
 * 5. Products derived from this software may not be called "OpenSSL"
 *    nor may "OpenSSL" appear in their names without prior written
 *    permission of the OpenSSL Project.
 *
 * 6. Redistributions of any form whatsoever must retain the following
 *    acknowledgment:
 *    "This product includes software developed by the OpenSSL Project
 *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"
 *
 * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
 * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
 * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
 * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 * ====================================================================
 *
 * This product includes cryptographic software written by Eric Young
 * (eay@cryptsoft.com).  This product includes software written by Tim
 * Hudson (tjh@cryptsoft.com).
 *
 */

#include "bn_lcl.h"

#ifndef OPENSSL_NO_DH
#include "internal/bn_dh.h"
/* DH parameters from RFC5114 */

static const BN_ULONG dh1024_160_p[] = {
    BN_PACK2(DF1FB2BC, 2E4A4371), BN_PACK2(E68CFDA7, 6D4DA708), BN_PACK2(45BF37DF, 365C1A65),
    BN_PACK2(A151AF5F, 0DC8B4BD), BN_PACK2(FAA31A4F, F55BCCC0), BN_PACK2(4EFFD6FA, E5644738),
    BN_PACK2(98488E9C, 219A7372), BN_PACK2(ACCBDD7D, 90C4BD70), BN_PACK2(24975C3C, D49B83BF),
    BN_PACK2(13ECB4AE, A9061123), BN_PACK2(9838EF1E, 2EE652C0), BN_PACK2(6073E286, 75A23D18),
    BN_PACK2(9A6A9DCA, 52D23B61), BN_PACK2(52C99FBC, FB06A3C6), BN_PACK2(DE92DE5E, AE5D54EC),
    BN_PACK2(B10B8F96, A080E01D)
};

static const BN_ULONG dh1024_160_g[] = {
    BN_PACK2(855E6EEB, 22B3B2E5), BN_PACK2(858F4DCE, F97C2A24), BN_PACK2(2D779D59, 18D08BC8),
    BN_PACK2(D662A4D1, 8E73AFA3), BN_PACK2(1DBF0A01, 69B6A28A), BN_PACK2(A6A24C08, 7A091F53),
    BN_PACK2(909D0D22, 63F80A76), BN_PACK2(D7FBD7D3, B9A92EE1), BN_PACK2(5E91547F, 9E2749F4),
    BN_PACK2(160217B4, B01B886A), BN_PACK2(777E690F, 5504F213), BN_PACK2(266FEA1E, 5C41564B),
    BN_PACK2(D6406CFF, 14266D31), BN_PACK2(F8104DD2, 58AC507F), BN_PACK2(6765A442, EFB99905),
    BN_PACK2(A4D1CBD5, C3FD3412)
};

static const BN_ULONG dh1024_160_q[] = {
    BN_PACK2(64B7CB9D, 49462353), BN_PACK2(81A8DF27, 8ABA4E7D), 0xF518AA87
};

static const BN_ULONG dh2048_224_p[] = {
    BN_PACK2(0AC4DFFE, 0C10E64F), BN_PACK2(CF9DE538, 4E71B81C), BN_PACK2(7EF363E2, FFA31F71),
    BN_PACK2(E3FB73C1, 6B8E75B9), BN_PACK2(C9B53DCF, 4BA80A29), BN_PACK2(23F10B0E, 16E79763),
    BN_PACK2(C52172E4, 13042E9B), BN_PACK2(BE60E69C, C928B2B9), BN_PACK2(80CD86A1, B9E587E8),
    BN_PACK2(315D75E1, 98C641A4), BN_PACK2(CDF93ACC, 44328387), BN_PACK2(15987D9A, DC0A486D),
    BN_PACK2(7310F712, 1FD5A074), BN_PACK2(278273C7, DE31EFDC), BN_PACK2(1602E714, 415D9330),
    BN_PACK2(81286130, BC8985DB), BN_PACK2(B3BF8A31, 70918836), BN_PACK2(6A00E0A0, B9C49708),
    BN_PACK2(C6BA0B2C, 8BBC27BE), BN_PACK2(C9F98D11, ED34DBF6), BN_PACK2(7AD5B7D0, B6C12207),
    BN_PACK2(D91E8FEF, 55B7394B), BN_PACK2(9037C9ED, EFDA4DF8), BN_PACK2(6D3F8152, AD6AC212),
    BN_PACK2(1DE6B85A, 1274A0A6), BN_PACK2(EB3D688A, 309C180E), BN_PACK2(AF9A3C40, 7BA1DF15),
    BN_PACK2(E6FA141D, F95A56DB), BN_PACK2(B54B1597, B61D0A75), BN_PACK2(A20D64E5, 683B9FD1),
    BN_PACK2(D660FAA7, 9559C51F), BN_PACK2(AD107E1E, 9123A9D0)
};

static const BN_ULONG dh2048_224_g[] = {
    BN_PACK2(84B890D3, 191F2BFA), BN_PACK2(81BC087F, 2A7065B3), BN_PACK2(19C418E1, F6EC0179),
    BN_PACK2(7B5A0F1C, 71CFFF4C), BN_PACK2(EDFE72FE, 9B6AA4BD), BN_PACK2(81E1BCFE, 94B30269),
    BN_PACK2(566AFBB4, 8D6C0191), BN_PACK2(B539CCE3, 409D13CD), BN_PACK2(6AA21E7F, 5F2FF381),
    BN_PACK2(D9E263E4, 770589EF), BN_PACK2(10E183ED, D19963DD), BN_PACK2(B70A8137, 150B8EEB),
    BN_PACK2(051AE3D4, 28C8F8AC), BN_PACK2(BB77A86F, 0C1AB15B), BN_PACK2(6E3025E3, 16A330EF),
    BN_PACK2(19529A45, D6F83456), BN_PACK2(F180EB34, 118E98D1), BN_PACK2(B5F6C6B2, 50717CBE),
    BN_PACK2(09939D54, DA7460CD), BN_PACK2(E2471504, 22EA1ED4), BN_PACK2(B8A762D0, 521BC98A),
    BN_PACK2(F4D02727, 5AC1348B), BN_PACK2(C1766910, 1999024A), BN_PACK2(BE5E9001, A8D66AD7),
    BN_PACK2(C57DB17C, 620A8652), BN_PACK2(AB739D77, 00C29F52), BN_PACK2(DD921F01, A70C4AFA),
    BN_PACK2(A6824A4E, 10B9A6F0), BN_PACK2(74866A08, CFE4FFE3), BN_PACK2(6CDEBE7B, 89998CAF),
    BN_PACK2(9DF30B5C, 8FFDAC50), BN_PACK2(AC4032EF, 4F2D9AE3)
};

static const BN_ULONG dh2048_224_q[] = {
    BN_PACK2(BF389A99, B36371EB), BN_PACK2(1F80535A, 4738CEBC), BN_PACK2(C58D93FE, 99717710),
    0x801C0D34
};

static const BN_ULONG dh2048_256_p[] = {
    BN_PACK2(DB094AE9, 1E1A1597), BN_PACK2(693877FA, D7EF09CA), BN_PACK2(6116D227, 6E11715F),
    BN_PACK2(A4B54330, C198AF12), BN_PACK2(75F26375, D7014103), BN_PACK2(C3A3960A, 54E710C3),
    BN_PACK2(DED4010A, BD0BE621), BN_PACK2(C0B857F6, 89962856), BN_PACK2(B3CA3F79, 71506026),
    BN_PACK2(1CCACB83, E6B486F6), BN_PACK2(67E144E5, 14056425), BN_PACK2(F6A167B5, A41825D9),
    BN_PACK2(3AD83477, 96524D8E), BN_PACK2(F13C6D9A, 51BFA4AB), BN_PACK2(2D525267, 35488A0E),
    BN_PACK2(B63ACAE1, CAA6B790), BN_PACK2(4FDB70C5, 81B23F76), BN_PACK2(BC39A0BF, 12307F5C),
    BN_PACK2(B941F54E, B1E59BB8), BN_PACK2(6C5BFC11, D45F9088), BN_PACK2(22E0B1EF, 4275BF7B),
    BN_PACK2(91F9E672, 5B4758C0), BN_PACK2(5A8A9D30, 6BCF67ED), BN_PACK2(209E0C64, 97517ABD),
    BN_PACK2(3BF4296D, 830E9A7C), BN_PACK2(16C3D911, 34096FAA), BN_PACK2(FAF7DF45, 61B2AA30),
    BN_PACK2(E00DF8F1, D61957D4), BN_PACK2(5D2CEED4, 435E3B00), BN_PACK2(8CEEF608, 660DD0F2),
    BN_PACK2(FFBBD19C, 65195999), BN_PACK2(87A8E61D, B4B6663C)
};

static const BN_ULONG dh2048_256_g[] = {
    BN_PACK2(664B4C0F, 6CC41659), BN_PACK2(5E2327CF, EF98C582), BN_PACK2(D647D148, D4795451),
    BN_PACK2(2F630784, 90F00EF8), BN_PACK2(184B523D, 1DB246C3), BN_PACK2(C7891428, CDC67EB6),
    BN_PACK2(7FD02837, 0DF92B52), BN_PACK2(B3353BBB, 64E0EC37), BN_PACK2(ECD06E15, 57CD0915),
    BN_PACK2(B7D2BBD2, DF016199), BN_PACK2(C8484B1E, 052588B9), BN_PACK2(DB2A3B73, 13D3FE14),
    BN_PACK2(D052B985, D182EA0A), BN_PACK2(A4BD1BFF, E83B9C80), BN_PACK2(DFC967C1, FB3F2E55),
    BN_PACK2(B5045AF2, 767164E1), BN_PACK2(1D14348F, 6F2F9193), BN_PACK2(64E67982, 428EBC83),
    BN_PACK2(8AC376D2, 82D6ED38), BN_PACK2(777DE62A, AAB8A862), BN_PACK2(DDF463E5, E9EC144B),
    BN_PACK2(0196F931, C77A57F2), BN_PACK2(A55AE313, 41000A65), BN_PACK2(901228F8, C28CBB18),
    BN_PACK2(BC3773BF, 7E8C6F62), BN_PACK2(BE3A6C1B, 0C6B47B1), BN_PACK2(FF4FED4A, AC0BB555),
    BN_PACK2(10DBC150, 77BE463F), BN_PACK2(07F4793A, 1A0BA125), BN_PACK2(4CA7B18F, 21EF2054),
    BN_PACK2(2E775066, 60EDBD48), BN_PACK2(3FB32C9B, 73134D0B)
};

static const BN_ULONG dh2048_256_q[] = {
    BN_PACK2(A308B0FE, 64F5FBD3), BN_PACK2(99B1A47D, 1EB3750B), BN_PACK2(B4479976, 40129DA2),
    BN_PACK2(8CF83642, A709A097)
};

/* Macro to make a BIGNUM from static data */

# define make_dh_bn(x) extern const BIGNUM _bignum_##x; \
                       const BIGNUM _bignum_##x = BN_STATIC_INIT(x);

make_dh_bn(dh1024_160_p)
make_dh_bn(dh1024_160_g)
make_dh_bn(dh1024_160_q)
make_dh_bn(dh2048_224_p)
make_dh_bn(dh2048_224_g)
make_dh_bn(dh2048_224_q)
make_dh_bn(dh2048_256_p)
make_dh_bn(dh2048_256_g)
make_dh_bn(dh2048_256_q)

#endif
