=pod

=head1 NAME

X509v3_addr_get_afi, X509v3_addr_get_safi
- get AFI and SAFI from RFC 3779 IPAddressFamily

=head1 SYNOPSIS

 #include <openssl/x509v3.h>

 unsigned int X509v3_addr_get_afi(const IPAddressFamily *f);
 const unsigned char *X509v3_addr_get_safi(const IPAddressFamily *f);

=head1 DESCRIPTION

These functions extract the Address Family Identifier (AFI) and
Sub-Address Family Identifier (SAFI) from an B<IPAddressFamily>
structure as defined in RFC 3779.

X509v3_addr_get_afi() returns the AFI value from the B<IPAddressFamily>
structure I<f>. The AFI is a 16-bit identifier that specifies the
address family. Common values include B<IANA_AFI_IPV4> (1) for IPv4
and B<IANA_AFI_IPV6> (2) for IPv6.

X509v3_addr_get_safi() returns a pointer to the SAFI byte within the
B<IPAddressFamily> structure I<f>, or NULL if no SAFI is present.
The SAFI is optional in the IPAddressFamily structure and is only
present when the addressFamily field has a length greater than 2 bytes.

=head1 RETURN VALUES

X509v3_addr_get_afi() returns the AFI value as an unsigned integer,
or 0 if I<f> is NULL or malformed.

X509v3_addr_get_safi() returns a pointer to the SAFI byte, or NULL
if I<f> is NULL, malformed, or does not contain a SAFI.

=head1 SEE ALSO

L<X509_get_ext_d2i(3)>

=head1 HISTORY

X509v3_addr_get_afi() was added in OpenSSL 1.0.2.

X509v3_addr_get_safi() was added in OpenSSL 3.6.

=head1 COPYRIGHT

Copyright 2026 The OpenSSL Project Authors. All Rights Reserved.

Licensed under the Apache License 2.0 (the "License").  You may not use
this file except in compliance with the License.  You can obtain a copy
in the file LICENSE in the source distribution or at
L<https://www.openssl.org/source/license.html>.

=cut
