#----- Digests
$DER_DIGESTS_H=../include/prov/der_digests.h
$DER_DIGESTS_GEN=der_digests_gen.c

GENERATE[$DER_DIGESTS_GEN]=der_digests_gen.c.in
DEPEND[$DER_DIGESTS_GEN]=oids_to_c.pm

DEPEND[${DER_DIGESTS_GEN/.c/.o}]=$DER_DIGESTS_H
GENERATE[$DER_DIGESTS_H]=der_digests.h.in
DEPEND[$DER_DIGESTS_H]=oids_to_c.pm

#----- RSA
$DER_RSA_H=../include/prov/der_rsa.h
$DER_RSA_GEN=der_rsa_gen.c
$DER_RSA_AUX=der_rsa_key.c der_rsa_sig.c
$DER_RSA_COMMON=$DER_RSA_GEN der_rsa_sig.c
$DER_RSA_FIPSABLE=der_rsa_key.c

GENERATE[$DER_RSA_GEN]=der_rsa_gen.c.in
DEPEND[$DER_RSA_GEN]=oids_to_c.pm

DEPEND[${DER_RSA_AUX/.c/.o}]=$DER_RSA_H $DER_DIGESTS_H
DEPEND[${DER_RSA_GEN/.c/.o}]=$DER_RSA_H
GENERATE[$DER_RSA_H]=der_rsa.h.in
DEPEND[$DER_RSA_H]=oids_to_c.pm

#----- DSA
$DER_DSA_H=../include/prov/der_dsa.h
$DER_DSA_GEN=der_dsa_gen.c
$DER_DSA_AUX=der_dsa_key.c der_dsa_sig.c

GENERATE[$DER_DSA_GEN]=der_dsa_gen.c.in
DEPEND[$DER_DSA_GEN]=oids_to_c.pm

DEPEND[${DER_DSA_AUX/.c/.o}]=$DER_DSA_H $DER_DIGESTS_H
DEPEND[${DER_DSA_GEN/.c/.o}]=$DER_DSA_H
GENERATE[$DER_DSA_H]=der_dsa.h.in
DEPEND[$DER_DSA_H]=oids_to_c.pm

#----- EC
$DER_EC_H=../include/prov/der_ec.h
$DER_EC_GEN=der_ec_gen.c
$DER_EC_AUX=der_ec_key.c der_ec_sig.c

GENERATE[$DER_EC_GEN]=der_ec_gen.c.in
DEPEND[$DER_EC_GEN]=oids_to_c.pm

DEPEND[${DER_EC_AUX/.c/.o}]=$DER_EC_H $DER_DIGESTS_H
DEPEND[${DER_EC_GEN/.c/.o}]=$DER_EC_H
GENERATE[$DER_EC_H]=der_ec.h.in
DEPEND[$DER_EC_H]=oids_to_c.pm

#----- Conclusion

# TODO(3.0) $COMMON should go to libcommon.a, but this currently leads
# to linking conflicts, so we add it to libfips.a and libnonfips.a for
# the moment being
$COMMON=\
        $DER_RSA_COMMON \
        $DER_DSA_GEN $DER_DSA_AUX \
        $DER_EC_GEN $DER_EC_AUX \
        $DER_DIGESTS_GEN
SOURCE[../../libfips.a]=$COMMON $DER_RSA_FIPSABLE
SOURCE[../../libnonfips.a]=$COMMON $DER_RSA_FIPSABLE
