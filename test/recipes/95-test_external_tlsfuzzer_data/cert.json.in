[
    {"server_command": ["@SERVER@", "s_server", "-www",
                        "-key", "tests/serverX509Key.pem",
                        "-cert", "tests/serverX509Cert.pem",
                        "-verify", "1",
                        "-CAfile", "tests/clientX509Cert.pem"],
     "comment": "Use ANY certificate just to ensure that server tries to authorise a client",
     "environment": {"PYTHONPATH" : "."},
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
       {"name" : "test-tls13-certificate-verify.py",
        "arguments" : ["-k", "tests/clientX509Key.pem",
                       "-c", "tests/clientX509Cert.pem",
                       "-s", "ecdsa_secp256r1_sha256 ecdsa_secp384r1_sha384 ecdsa_secp521r1_sha512 ed25519 ed448 8+26 8+27 8+28 rsa_pss_pss_sha256 rsa_pss_pss_sha384 rsa_pss_pss_sha512 rsa_pss_rsae_sha256 rsa_pss_rsae_sha384 rsa_pss_rsae_sha512 rsa_pkcs1_sha256 rsa_pkcs1_sha384 rsa_pkcs1_sha512 ecdsa_sha224 rsa_pkcs1_sha224",
                       "-p", "@PORT@"]},
       {"name" : "test-tls13-ecdsa-in-certificate-verify.py",
          "arguments" : ["-k", "tests/serverECKey.pem",
                         "-c", "tests/serverECCert.pem",
                         "-s", "ecdsa_secp256r1_sha256 ecdsa_secp384r1_sha384 ecdsa_secp521r1_sha512 ed25519 ed448 8+26 8+27 8+28 rsa_pss_pss_sha256 rsa_pss_pss_sha384 rsa_pss_pss_sha512 rsa_pss_rsae_sha256 rsa_pss_rsae_sha384 rsa_pss_rsae_sha512 rsa_pkcs1_sha256 rsa_pkcs1_sha384 rsa_pkcs1_sha512 ecdsa_sha224 rsa_pkcs1_sha224",
                         "-p", "@PORT@"]}
     ]
    },
    {"server_command": ["@SERVER@", "s_server", "-www",
                 "-key", "tests/serverX509Key.pem",
                 "-cert", "tests/serverX509Cert.pem",
                 "-verify", "1", "-CAfile", "tests/clientX509Cert.pem",
                 "-client_sigalgs", "RSA+SHA384:rsa_pss_rsae_sha384:rsa_pss_pss_sha384"],
     "comment": "set -client_sigalgs because of https://github.com/openssl/openssl/issues/25277",
     "environment": {"PYTHONPATH" : "."},
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
       {"name" : "test-certificate-verify-malformed.py",
        "arguments" : ["-d", "-k", "tests/clientX509Key.pem",
                       "-c", "tests/clientX509Cert.pem",
                       "-p", "@PORT@"]}
     ]
    },
    {"server_command": ["@SERVER@", "s_server", "-www",
                 "-key", "tests/serverX509Key.pem",
                 "-cert", "tests/serverX509Cert.pem"],
     "environment": {"PYTHONPATH" : "."},
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
       {"name" : "test-tls13-conversation.py",
        "arguments" : ["-p", "@PORT@"]},
       {"name" : "test-conversation.py",
        "arguments" : ["-p", "@PORT@",
                       "-d"]}
     ]
    },
    {"server_command": ["@SERVER@", "s_server", "-www",
                 "-key", "@DATADIR@/rsae-2k.key",
                 "-cert", "@DATADIR@/rsae-2k.crt",
                 "-cipher", "DEFAULT:@SECLEVEL=0"],
     "environment": {"PYTHONPATH" : "."},
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
       {"name" : "test-dhe-rsa-key-exchange-signatures.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "-x",
        "TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA sha1 signature", "-X",
        "handshake_failure", "-x",
        "TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA sha224 signature", "-X",
        "handshake_failure", "-x",
        "TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA sha256 signature", "-X",
        "handshake_failure", "-x",
        "TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA sha384 signature",
        "-X", "handshake_failure", "-x",
        "TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA sha512 signature", "-X",
        "handshake_failure"]},
       {"name" : "test-sig-algs.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "-x",
        "rsa_pss_pss_sha256 only", "-X", "handshake_failure", "-x",
        "rsa_pss_pss_sha384 only", "-X", "handshake_failure", "-x",
        "rsa_pss_pss_sha512 only", "-X", "handshake_failure"]},
       {"name" : "test-signature-algorithms.py",
        "arguments" : ["-p", "@PORT@", "-n", "0"]},
       {"name" : "test-tls13-rsa-signatures.py",
        "arguments" : ["-p", "@PORT@", "-n", "0"]},
       {"name" : "test-tls13-signature-algorithms.py",
        "arguments" : ["-p", "@PORT@", "-n", "0"]}
     ]
    },
    {"server_command": ["@SERVER@", "s_server", "-www",
                 "-key", "@DATADIR@/rsa-pss-2k.key",
                 "-cert", "@DATADIR@/rsa-pss-2k.crt"],
     "environment": {"PYTHONPATH" : "."},
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
       {"name" : "test-sig-algs.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "-x",
        "rsa_pss_rsae_sha256 only", "-X", "handshake_failure", "-x",
        "rsa_pss_rsae_sha384 only", "-X", "handshake_failure", "-x",
        "rsa_pss_rsae_sha512 only", "-X", "handshake_failure"]},
       {"name" : "test-tls13-rsapss-signatures.py",
        "arguments" : ["-p", "@PORT@", "-n", "0"]},
       {"name" : "test-tls13-signature-algorithms.py",
        "arguments" : ["-p", "@PORT@", "-n", "0"]}
     ]
    },
    {"server_command": ["@SERVER@", "s_server", "-www",
                 "-key", "@DATADIR@/secp256r1.key",
                 "-cert", "@DATADIR@/secp256r1.crt", "-cipher", "DEFAULT:@SECLEVEL=0"],
     "environment": {"PYTHONPATH" : "."},
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
       {"name" : "test-ecdsa-sig-flexibility.py",
        "arguments" : ["-p", "@PORT@", "-n", "0"]},
       {"name" : "test-signature-algorithms.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "--ecdsa"]},
       {"name" : "test-signature-algorithms.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "--ecdsa", "-g", "secp384r1",
        "-x", "sanity", "-X", "handshake_failure", "-x",
        "explicit SHA-256+RSA or ECDSA", "-X", "handshake_failure", "sanity",
        "explicit SHA-256+RSA or ECDSA"]},
       {"name" : "test-tls13-ecdsa-support.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "-x",
        "Test with ecdsa_secp384r1_sha384", "-X", "handshake_failure", "-x",
        "Test with ecdsa_secp521r1_sha512", "-X", "handshake_failure", "-x",
        "Test with ecdsa_brainpoolP256r1tls13_sha256", "-X",
        "handshake_failure", "-x",
        "Test with ecdsa_brainpoolP384r1tls13_sha384", "-X",
        "handshake_failure", "-x",
        "Test with ecdsa_brainpoolP512r1tls13_sha512", "-X",
        "handshake_failure"]}
     ]
    },
    {"server_command": ["@SERVER@", "s_server", "-www",
                 "-key", "@DATADIR@/secp384r1.key",
                 "-cert", "@DATADIR@/secp384r1.crt", "-cipher", "DEFAULT:@SECLEVEL=0"],
     "environment": {"PYTHONPATH" : "."},
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
       {"name" : "test-ecdsa-sig-flexibility.py",
        "arguments" : ["-p", "@PORT@", "-n", "0"]},
       {"name" : "test-signature-algorithms.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "--ecdsa", "-g", "secp384r1"]},
       {"name" : "test-signature-algorithms.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "--ecdsa", "-g", "secp256r1",
        "-x", "sanity", "-X", "handshake_failure", "-x",
        "explicit SHA-256+RSA or ECDSA", "-X", "handshake_failure", "sanity",
        "explicit SHA-256+RSA or ECDSA"]},
       {"name" : "test-tls13-ecdsa-support.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "-x",
        "Test with ecdsa_secp256r1_sha256", "-X", "handshake_failure", "-x",
        "Test with ecdsa_secp521r1_sha512", "-X", "handshake_failure", "-x",
        "Test with ecdsa_brainpoolP256r1tls13_sha256", "-X",
        "handshake_failure", "-x",
        "Test with ecdsa_brainpoolP384r1tls13_sha384", "-X",
        "handshake_failure", "-x",
        "Test with ecdsa_brainpoolP512r1tls13_sha512", "-X",
        "handshake_failure"]}
     ]
    },
    {"server_command": ["@SERVER@", "s_server", "-www",
                 "-key", "@DATADIR@/secp521r1.key",
                 "-cert", "@DATADIR@/secp521r1.crt", "-cipher", "DEFAULT:@SECLEVEL=0"],
     "environment": {"PYTHONPATH" : "."},
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
       {"name" : "test-ecdsa-sig-flexibility.py",
        "arguments" : ["-p", "@PORT@", "-n", "0"]},
       {"name" : "test-signature-algorithms.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "--ecdsa", "-g", "secp521r1"]},
       {"name" : "test-signature-algorithms.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "--ecdsa", "-g", "secp256r1",
        "-x", "sanity", "-X", "handshake_failure", "-x",
        "explicit SHA-256+RSA or ECDSA", "-X", "handshake_failure", "sanity",
        "explicit SHA-256+RSA or ECDSA"]},
       {"name" : "test-tls13-ecdsa-support.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "-x",
        "Test with ecdsa_secp256r1_sha256", "-X", "handshake_failure", "-x",
        "Test with ecdsa_secp384r1_sha384", "-X", "handshake_failure", "-x",
        "Test with ecdsa_brainpoolP256r1tls13_sha256", "-X",
        "handshake_failure", "-x",
        "Test with ecdsa_brainpoolP384r1tls13_sha384", "-X",
        "handshake_failure", "-x",
        "Test with ecdsa_brainpoolP512r1tls13_sha512", "-X",
        "handshake_failure"]}
     ]
    },
    {"server_command": ["@SERVER@", "s_server", "-www",
                 "-key", "@DATADIR@/brainpoolP256r1.key",
                 "-cert", "@DATADIR@/brainpoolP256r1.crt", "-curves",
                 "brainpoolP256r1:brainpoolP256r1tls13", "-cipher",
                 "DEFAULT:@SECLEVEL=0"],
     "environment": {"PYTHONPATH" : "."},
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
       {"name" : "test-ecdsa-sig-flexibility.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "-g", "brainpoolP256r1"]},
       {"name" : "test-signature-algorithms.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "--ecdsa", "-g", "brainpoolP256r1"]},
       {"name" : "test-signature-algorithms.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "--ecdsa", "-g", "secp256r1",
        "-x", "sanity", "-X", "handshake_failure", "-x",
        "explicit SHA-256+RSA or ECDSA", "-X", "handshake_failure", "sanity",
        "explicit SHA-256+RSA or ECDSA"]},
       {"name" : "test-tls13-ecdsa-support.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "-g", "brainpoolP256r1tls13",
        "-x", "Test with ecdsa_brainpoolP384r1tls13_sha384", "-X",
        "handshake_failure", "-x",
        "Test with ecdsa_brainpoolP512r1tls13_sha512", "-X",
        "handshake_failure", "-x", "Test with ecdsa_secp256r1_sha256", "-X",
        "handshake_failure", "-x", "Test with ecdsa_secp384r1_sha384", "-X",
        "handshake_failure", "-x", "Test with ecdsa_secp521r1_sha512", "-X",
        "handshake_failure"]}
     ]
    },
    {"server_command": ["@SERVER@", "s_server", "-www",
                 "-key", "@DATADIR@/brainpoolP384r1.key",
                 "-cert", "@DATADIR@/brainpoolP384r1.crt", "-curves",
                 "brainpoolP384r1:brainpoolP384r1tls13", "-cipher",
                 "DEFAULT:@SECLEVEL=0"],
     "environment": {"PYTHONPATH" : "."},
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
       {"name" : "test-ecdsa-sig-flexibility.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "-g", "brainpoolP384r1"]},
       {"name" : "test-signature-algorithms.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "--ecdsa", "-g", "brainpoolP384r1"]},
       {"name" : "test-signature-algorithms.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "--ecdsa", "-g", "secp256r1",
        "-x", "sanity", "-X", "handshake_failure", "-x",
        "explicit SHA-256+RSA or ECDSA", "-X", "handshake_failure", "sanity",
        "explicit SHA-256+RSA or ECDSA"]},
       {"name" : "test-tls13-ecdsa-support.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "-g", "brainpoolP384r1tls13",
        "-x", "Test with ecdsa_brainpoolP256r1tls13_sha256", "-X",
        "handshake_failure", "-x",
        "Test with ecdsa_brainpoolP512r1tls13_sha512", "-X",
        "handshake_failure", "-x", "Test with ecdsa_secp256r1_sha256", "-X",
        "handshake_failure", "-x", "Test with ecdsa_secp384r1_sha384", "-X",
        "handshake_failure", "-x", "Test with ecdsa_secp521r1_sha512", "-X",
        "handshake_failure"]}
     ]
    },
    {"server_command": ["@SERVER@", "s_server", "-www",
                 "-key", "@DATADIR@/brainpoolP512r1.key",
                 "-cert", "@DATADIR@/brainpoolP512r1.crt", "-curves",
                 "brainpoolP512r1:brainpoolP512r1tls13", "-cipher",
                 "DEFAULT:@SECLEVEL=0"],
     "environment": {"PYTHONPATH" : "."},
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
       {"name" : "test-ecdsa-sig-flexibility.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "-g", "brainpoolP512r1"]},
       {"name" : "test-signature-algorithms.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "--ecdsa", "-g", "brainpoolP512r1"]},
       {"name" : "test-signature-algorithms.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "--ecdsa", "-g", "secp256r1",
        "-x", "sanity", "-X", "handshake_failure", "-x",
        "explicit SHA-256+RSA or ECDSA", "-X", "handshake_failure", "sanity",
        "explicit SHA-256+RSA or ECDSA"]},
       {"name" : "test-tls13-ecdsa-support.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "-g", "brainpoolP512r1tls13",
        "-x", "Test with ecdsa_brainpoolP256r1tls13_sha256", "-X",
        "handshake_failure", "-x",
        "Test with ecdsa_brainpoolP384r1tls13_sha384", "-X",
        "handshake_failure", "-x", "Test with ecdsa_secp256r1_sha256", "-X",
        "handshake_failure", "-x", "Test with ecdsa_secp384r1_sha384", "-X",
        "handshake_failure", "-x", "Test with ecdsa_secp521r1_sha512", "-X",
        "handshake_failure"]}
     ]
    },
    {"server_command": ["@SERVER@", "s_server", "-www",
                 "-key", "@DATADIR@/ed25519.key",
                 "-cert", "@DATADIR@/ed25519.crt", "-cipher",
                 "DEFAULT:@SECLEVEL=0"],
     "environment": {"PYTHONPATH" : "."},
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
       {"name" : "test-signature-algorithms.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "--ecdsa", "-x",
        "implicit SHA-1 check", "-X", "handshake_failure", "sanity",
        "implicit SHA-1 check"]},
       {"name" : "test-tls13-eddsa.py",
        "arguments" : ["-p", "@PORT@", "-x", "ed448 only", "-X",
        "handshake_failure"]}
     ]
    },
    {"server_command": ["@SERVER@", "s_server", "-www",
                 "-key", "@DATADIR@/ed448.key",
                 "-cert", "@DATADIR@/ed448.crt", "-cipher",
                 "DEFAULT:@SECLEVEL=0"],
     "environment": {"PYTHONPATH" : "."},
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
       {"name" : "test-signature-algorithms.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "--ecdsa", "-x",
        "implicit SHA-1 check", "-X", "handshake_failure", "sanity",
        "implicit SHA-1 check"]},
       {"name" : "test-tls13-eddsa.py",
        "arguments" : ["-p", "@PORT@", "-x", "ed25519 only", "-X",
        "handshake_failure"]}
     ]
    },
    {"server_command": ["@SERVER@", "s_server", "-www",
                 "-key", "@DATADIR@/dsa-2k.key",
                 "-cert", "@DATADIR@/dsa-2k.crt", "-cipher",
                 "ALL:@SECLEVEL=0"],
     "environment": {"PYTHONPATH" : "."},
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
       {"name" : "test-dsa-sig-flexibility.py",
        "arguments" : ["-p", "@PORT@"]}
     ]
    },

    {"server_command": ["@SERVER@", "s_server", "-www",
                 "-CAfile", "@DATADIR@/rsa-ca.pem",
                 "-key", "@DATADIR@/rsa-server-key.pem",
                 "-cert", "@DATADIR@/rsa-server.pem",
                 "-Verify", "1",
                 "-cipher", "DEFAULT:@SECLEVEL=0"],
     "environment": {"PYTHONPATH" : "."},
     "server_hostname": "localhost",
     "server_port": @PORT@,
     "tests" : [
       {"name" : "test-rsa-sigs-on-certificate-verify.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "-k",
        "@DATADIR@/rsa-client-key.pem", "-c", "@DATADIR@/rsa-client.pem"]},
       {"name" : "test-rsa-pss-sigs-on-certificate-verify.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "-k",
        "@DATADIR@/rsa-client-key.pem", "-c", "@DATADIR@/rsa-client.pem"]},
       {"name" : "test-certificate-verify-malformed-sig.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "-k",
        "@DATADIR@/rsa-client-key.pem", "-c", "@DATADIR@/rsa-client.pem"]},
       {"name" : "test-tls13-certificate-verify.py",
        "arguments" : ["-p", "@PORT@", "-n", "0", "-k",
        "@DATADIR@/rsa-client-key.pem", "-c", "@DATADIR@/rsa-client.pem"]}
     ]
    }
]
